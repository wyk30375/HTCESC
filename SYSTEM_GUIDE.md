# 二手车销售管理系统 - 系统说明

## 系统概述

这是一个完整的二手车销售管理系统，采用现代化的技术栈构建，提供了从车辆入库、销售管理到利润分配的全流程管理功能。

## 技术栈

- **前端框架**: React 18 + TypeScript
- **UI 组件库**: shadcn/ui + Tailwind CSS
- **路由管理**: React Router v6
- **状态管理**: React Context + Hooks
- **数据库**: Supabase (PostgreSQL)
- **认证系统**: Supabase Auth
- **文件存储**: Supabase Storage
- **图片压缩**: browser-image-compression
- **构建工具**: Vite

## 核心功能

### 1. 认证系统
- ✅ 用户注册/登录（用户名+密码）
- ✅ 首个注册用户自动成为管理员
- ✅ 基于角色的权限控制（管理员/员工）
- ✅ 路由守卫保护

### 2. 员工管理
- ✅ 员工信息管理（姓名、职位、联系方式、入职日期）
- ✅ 多角色分配系统：
  - 地租（18%）
  - 月奖金池（10%）
  - 销售提成（36%）
  - 押车出资人（36%）
- ✅ 支持一人多角色、多人一角色
- ✅ 角色分配比例自定义

### 3. 车辆管理
- ✅ 车辆入库（车架号后六位作为唯一标识）
- ✅ 车辆信息录入（品牌、型号、年份、里程、车况等）
- ✅ 车辆照片上传（支持多张，自动压缩至1MB以下）
- ✅ 成本记录（购车款、整备费、过户费、杂费）
- ✅ 车辆状态管理（在售/已售）

### 4. 销售管理
- ✅ 销售记录（基础版）
- 🚧 销售信息录入（待完善）
- 🚧 贷款返利记录（待完善）
- 🚧 利润自动计算（待完善）

### 5. 费用管理
- ✅ 费用记录（基础版）
- 🚧 费用分类管理（待完善）
- 🚧 月度费用统计（待完善）

### 6. 利润分配
- ✅ 利润分配记录（基础版）
- 🚧 自动利润分配计算（待完善）
- 🚧 月度奖金池管理（待完善）
- 🚧 销售冠军奖金（待完善）

### 7. 统计分析
- ✅ 仪表盘概览
- 🚧 月度销售统计（待完善）
- 🚧 员工业绩排行（待完善）
- 🚧 销售趋势图表（待完善）

### 8. 手机端展示
- ✅ 客户端车辆展示（无需登录）
- ✅ 车辆列表展示
- 🚧 内部通报系统（待完善）

### 9. 管理员功能
- ✅ 用户管理
- ✅ 角色权限设置

## 数据库结构

### 核心表
1. **profiles** - 用户资料表
2. **employees** - 员工信息表
3. **employee_roles** - 员工角色关联表
4. **vehicles** - 车辆信息表
5. **vehicle_costs** - 车辆成本明细表
6. **vehicle_sales** - 车辆销售记录表
7. **expenses** - 费用记录表
8. **profit_distributions** - 利润分配记录表
9. **monthly_bonuses** - 月度奖金池表

### 存储桶
- **app_8u0242wc45c1_vehicle_images** - 车辆图片存储（1MB限制）

## 使用指南

### 首次使用

1. **注册管理员账号**
   - 访问系统登录页面
   - 点击"注册"标签
   - 输入用户名和密码（至少6位）
   - 第一个注册的用户自动成为管理员

2. **添加员工**
   - 登录后进入"员工管理"页面
   - 点击"添加员工"按钮
   - 填写员工信息
   - 为员工分配角色和分配比例

3. **车辆入库**
   - 进入"车辆管理"页面
   - 点击"车辆入库"按钮
   - 填写车辆详细信息
   - 上传车辆照片（自动压缩）
   - 系统会自动记录购车款成本

4. **客户展示**
   - 访问 `/customer-view` 页面
   - 无需登录即可查看在售车辆
   - 展示车辆照片、基本信息和车况

### 权限说明

#### 管理员权限
- 所有功能的完整访问权限
- 用户管理和角色设置
- 员工管理和角色分配
- 车辆入库和管理
- 销售记录和费用管理
- 利润分配和统计分析

#### 员工权限
- 查看车辆信息
- 查看销售记录
- 查看自己的业绩
- 查看利润分配

### 图片上传说明

- **支持格式**: JPEG, PNG, WEBP, GIF, AVIF
- **文件大小**: 最大 1MB（超过会自动压缩）
- **文件命名**: 只能包含英文字母和数字
- **压缩策略**: 
  - 自动转换为 WEBP 格式
  - 最大分辨率 1920px
  - 质量设置 0.8（必要时降至 0.6）

## 演示数据

系统已预置6辆演示车辆：
- 宝马 5系 (2020年)
- 奥迪 A6L (2019年)
- 奔驰 E级 (2021年)
- 丰田 凯美瑞 (2018年)
- 本田 雅阁 (2019年)
- 大众 帕萨特 (2020年)

## 配色方案

系统采用专业的汽车行业配色：
- **主色调**: 深蓝色 (hsl(215, 85%, 35%)) - 专业、可信赖
- **辅助色**: 灰蓝色 (hsl(215, 15%, 92%)) - 柔和、舒适
- **强调色**: 活力橙 (hsl(25, 95%, 53%)) - 活力、醒目
- **侧边栏**: 深色主题 (hsl(215, 25%, 15%))

## 待完善功能

以下功能已有基础框架，需要进一步开发：

1. **销售管理完整流程**
   - 销售信息详细录入
   - 贷款返利计算
   - 自动更新车辆状态
   - 自动触发利润分配

2. **利润分配自动化**
   - 根据销售记录自动计算利润
   - 按角色比例自动分配
   - 月度奖金池累计
   - 销售冠军自动评选

3. **统计分析增强**
   - 月度销售趋势图表
   - 员工业绩排行榜
   - 利润分配明细报表
   - 数据导出功能

4. **内部通报系统**
   - 每日销售通报
   - 月度业绩通报
   - 奖金池情况展示

## 注意事项

1. **首次登录**: 请先注册账号，第一个注册的用户会自动成为管理员
2. **员工关联**: 添加员工时需要先有对应的用户账号
3. **车架号**: 车架号后六位必须唯一，作为车辆的唯一标识
4. **图片上传**: 上传的图片会自动压缩，确保文件名只包含英文字母和数字
5. **角色分配**: 同一角色可以由多个员工共同担任，通过分配比例控制

## 技术支持

如有问题，请检查：
1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. Supabase 服务是否可用
4. 用户权限是否正确设置

## 版权信息

© 2026 二手车销售管理系统
