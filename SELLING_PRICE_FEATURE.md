# 车辆预售报价功能说明

## 🎯 功能概述

在车辆管理系统中新增"预售报价"字段，用于设置车辆的对外展示价格。公共展示页面将优先显示预售报价，如果未设置预售报价则显示购车款。

---

## 📋 功能详情

### 1. 预售报价字段
- **字段名称**：预售报价（selling_price）
- **字段类型**：数字（NUMERIC(12, 2)）
- **是否必填**：否（可选）
- **用途**：设置车辆的对外展示价格

### 2. 价格显示逻辑
- **公共展示页面**：优先显示预售报价，未设置时显示"价格面议"
- **车辆管理页面**：同时显示购车款和预售报价
- **价格计算**：`显示价格 = 预售报价 ? "¥" + 预售报价 : "价格面议"`

---

## 📝 使用说明

### 车辆入库时设置预售报价

#### 步骤1：进入车辆管理页面
1. 登录系统
2. 点击侧边栏"车辆管理"
3. 点击"添加车辆"按钮

#### 步骤2：填写车辆信息
1. 填写基本信息（车架号、车牌号、品牌型号等）
2. 填写技术参数（排量、变速箱、驱动等）
3. 填写外观信息（车身颜色、内饰颜色）
4. 填写车辆状态（车况、证件信息）

#### 步骤3：设置价格信息
在"价格信息"部分，填写以下字段：

| 字段 | 说明 | 是否必填 |
|------|------|---------|
| 新车指导价 | 新车购置价格 | 否 |
| 购车款 | 实际购入价格（成本） | **是** |
| 预售报价 | 对外展示价格 | 否 |

**重要说明**：
- **购车款**：必填，用于成本核算和利润计算
- **预售报价**：可选，用于公共展示页面显示
- 如果不填写预售报价，公共展示页面将显示"价格面议"

#### 步骤4：完成车辆入库
1. 选择押车出资人和场地老板
2. 上传车辆照片
3. 点击"保存"按钮

---

## 🔍 价格字段对比

### 三个价格字段的区别

| 字段 | 用途 | 显示位置 | 是否必填 |
|------|------|---------|---------|
| **新车指导价** | 参考价格 | 车辆列表、详情页 | 否 |
| **购车款** | 成本价格 | 车辆列表、成本核算 | **是** |
| **预售报价** | 展示价格 | 公共展示页面 | 否 |

### 价格关系示例

```
新车指导价：¥200,000（参考）
购车款：¥150,000（成本）
预售报价：¥180,000（对外展示）

公共展示页面显示：¥180,000
车辆管理页面显示：购车款 ¥150,000 | 预售报价 ¥180,000
```

### 未设置预售报价示例

```
新车指导价：¥200,000（参考）
购车款：¥150,000（成本）
预售报价：未设置

公共展示页面显示：价格面议
车辆管理页面显示：购车款 ¥150,000 | 预售报价 -
```

---

## 📊 公共展示页面价格显示

### 车辆卡片
- **位置**：车辆卡片中央
- **样式**：大号蓝色加粗字体
- **显示逻辑**：
  ```typescript
  显示价格 = 预售报价 ? `¥${预售报价.toLocaleString()}` : '价格面议'
  ```

### 车辆详情对话框
- **位置**：价格信息部分
- **标签**：售价
- **显示逻辑**：
  ```typescript
  售价 = 预售报价 ? `¥${预售报价.toLocaleString()}` : '价格面议'
  ```

### 显示示例

#### 情况1：已设置预售报价
```
车辆卡片：¥180,000
详情对话框：
  新车指导价：¥200,000
  售价：¥180,000
```

#### 情况2：未设置预售报价
```
车辆卡片：价格面议
详情对话框：
  新车指导价：¥200,000
  售价：价格面议
```

---

## 🔧 车辆管理页面

### 车辆列表
车辆列表现在包含25个字段列（新增预售报价列）：

| 序号 | 字段名称 | 位置 |
|------|---------|------|
| 1-18 | 基本信息、技术参数、外观、车况、证件 | 前18列 |
| 19 | 新车指导价 | 第19列 |
| 20 | 购车款 | 第20列 |
| **21** | **预售报价** | **第21列（新增）** |
| 22 | 押车出资人 | 第22列 |
| 23 | 场地老板 | 第23列 |
| 24 | 状态 | 第24列 |
| 25 | 操作 | 第25列 |

### 列表显示格式
- **新车指导价**：¥200,000 或 `-`（未填写）
- **购车款**：¥150,000（必填，始终显示）
- **预售报价**：¥180,000 或 `-`（未填写）

---

## 💡 使用场景

### 场景1：正常销售
```
购车款：¥150,000（成本）
预售报价：¥180,000（期望售价）

公共展示：¥180,000
利润空间：¥30,000
```

### 场景2：特价促销
```
购车款：¥150,000（成本）
预售报价：¥160,000（促销价）

公共展示：¥160,000
利润空间：¥10,000
```

### 场景3：未设置预售报价
```
购车款：¥150,000（成本）
预售报价：未设置

公共展示：价格面议
客户需联系车行询价
```

### 场景4：高端车辆
```
新车指导价：¥500,000（参考）
购车款：¥350,000（成本）
预售报价：¥420,000（期望售价）

公共展示：¥420,000
利润空间：¥70,000
```

---

## 🎨 界面展示

### 车辆入库表单 - 价格信息部分
```
┌─────────────────────────────────────────────┐
│  价格信息                                   │
├─────────────────────────────────────────────┤
│  新车指导价（元）        购车款（元）*      │
│  [200000            ]    [150000        ]   │
│                                             │
│  预售报价（元）                             │
│  [180000            ]                       │
│  对外展示价格                               │
└─────────────────────────────────────────────┘
```

### 车辆列表 - 价格列
```
┌────────────┬──────────┬──────────┬────────┐
│ 新车指导价 │ 购车款   │ 预售报价 │ 状态   │
├────────────┼──────────┼──────────┼────────┤
│ ¥200,000   │ ¥150,000 │ ¥180,000 │ 在售   │
│ ¥180,000   │ ¥120,000 │ -        │ 在售   │
│ ¥250,000   │ ¥180,000 │ ¥220,000 │ 在售   │
└────────────┴──────────┴──────────┴────────┘
```

### 公共展示页面 - 车辆卡片
```
┌─────────────────────────────────┐
│  [车辆照片]                     │
│                                 │
│  大众 帕萨特                    │
│  2020年 | 50,000公里            │
│                                 │
│  ¥180,000                       │
│  （显示预售报价）               │
│                                 │
│  车况良好，无重大事故...        │
│                                 │
│  XX二手车行    [📞 联系方式]   │
└─────────────────────────────────┘

未设置预售报价：
┌─────────────────────────────────┐
│  [车辆照片]                     │
│                                 │
│  大众 帕萨特                    │
│  2020年 | 50,000公里            │
│                                 │
│  价格面议                       │
│  （未设置预售报价）             │
│                                 │
│  车况良好，无重大事故...        │
│                                 │
│  XX二手车行    [📞 联系方式]   │
└─────────────────────────────────┘
```

---

## 🔒 数据安全

### 价格信息保护
- **购车款**：仅在车辆管理页面显示，不对外公开
- **预售报价**：在公共展示页面显示，对外公开
- **利润计算**：基于购车款，不受预售报价影响

### 权限控制
- **车行员工**：可查看购车款和预售报价
- **公共访客**：仅可查看预售报价（或购车款，如果未设置预售报价）

---

## 📈 业务价值

### 1. 价格灵活性
- 可根据市场情况调整预售报价
- 不影响成本核算
- 保护成本信息

### 2. 促销支持
- 可设置特价促销
- 可设置不同的展示价格
- 灵活应对市场变化

### 3. 利润保护
- 购车款不对外公开
- 利润空间不被客户知晓
- 保护商业机密

### 4. 数据分析
- 可对比预售报价和实际成交价
- 分析价格策略效果
- 优化定价策略

---

## 🔄 编辑预售报价

### 修改已入库车辆的预售报价

#### 步骤1：找到车辆
1. 进入车辆管理页面
2. 在"在售车辆"标签页找到目标车辆
3. 点击"编辑"按钮

#### 步骤2：修改预售报价
1. 在弹出的编辑对话框中找到"价格信息"部分
2. 修改"预售报价"字段
3. 点击"保存"按钮

#### 步骤3：验证修改
1. 在车辆列表中查看预售报价列
2. 访问公共展示页面查看显示价格
3. 确认价格已更新

---

## 📊 数据库结构

### vehicles表新增字段
```sql
ALTER TABLE vehicles
  ADD COLUMN IF NOT EXISTS selling_price NUMERIC(12, 2);

COMMENT ON COLUMN vehicles.selling_price IS '预售报价（对外展示价格）';

CREATE INDEX IF NOT EXISTS idx_vehicles_selling_price 
  ON vehicles(selling_price) 
  WHERE selling_price IS NOT NULL;
```

### 字段属性
- **字段名**：selling_price
- **数据类型**：NUMERIC(12, 2)
- **允许NULL**：是
- **默认值**：NULL
- **索引**：部分索引（仅索引非NULL值）

---

## 🎯 最佳实践

### 1. 设置预售报价的建议
- **合理定价**：预售报价应高于购车款，留有利润空间
- **市场调研**：参考同类车辆的市场价格
- **灵活调整**：根据市场反馈及时调整预售报价

### 2. 价格策略
- **新车入库**：建议设置预售报价，保护成本信息
- **长期库存**：可适当降低预售报价，加快销售
- **热门车型**：可设置较高预售报价，获取更多利润

### 3. 注意事项
- **购车款必填**：购车款是必填字段，用于成本核算
- **预售报价可选**：预售报价是可选字段，未设置时显示购车款
- **价格一致性**：确保预售报价与实际销售策略一致

---

## 🔍 常见问题

### Q1：预售报价和购车款有什么区别？
**A**：
- **购车款**：车辆的实际购入成本，用于成本核算和利润计算
- **预售报价**：车辆的对外展示价格，用于公共展示页面显示

### Q2：如果不设置预售报价会怎样？
**A**：如果不设置预售报价，公共展示页面将显示"价格面议"，客户需要联系车行询价。

### Q3：可以修改已入库车辆的预售报价吗？
**A**：可以。在车辆管理页面点击"编辑"按钮，修改预售报价后保存即可。

### Q4：预售报价可以低于购车款吗？
**A**：技术上可以，但不建议。预售报价应高于购车款，以确保有利润空间。

### Q5：预售报价会影响利润计算吗？
**A**：不会。利润计算基于购车款（成本）和实际成交价，预售报价仅用于展示。

### Q6：客户能看到购车款吗？
**A**：不能。购车款仅在车辆管理页面显示，公共展示页面仅显示预售报价或"价格面议"。

### Q7：如何批量设置预售报价？
**A**：目前需要逐个编辑车辆。未来可考虑添加批量编辑功能。

### Q8：预售报价支持小数吗？
**A**：支持。预售报价字段类型为NUMERIC(12, 2)，支持两位小数。

---

## 🚀 后续优化建议

### 1. 批量编辑
- 支持批量设置预售报价
- 支持按比例批量调整价格
- 支持批量导入导出

### 2. 价格历史
- 记录预售报价的修改历史
- 分析价格调整对销售的影响
- 生成价格趋势报告

### 3. 智能定价
- 根据市场数据推荐预售报价
- 根据车况自动计算建议价格
- 根据库存时长自动调整价格

### 4. 价格策略
- 支持设置价格区间
- 支持设置最低售价
- 支持设置议价空间

---

## ✅ 功能特点

### 1. 灵活定价
- 可独立设置对外展示价格
- 不影响成本核算
- 支持灵活调整

### 2. 信息保护
- 购车款不对外公开
- 保护商业机密
- 保护利润空间

### 3. 易于使用
- 表单界面简洁
- 字段说明清晰
- 操作流程简单

### 4. 数据完整
- 同时记录成本和售价
- 支持价格对比分析
- 便于数据统计

---

**现在您可以为车辆设置预售报价，在公共展示页面显示更合适的价格了！🎉**
