# 任务：二手车销售管理系统

## 计划
- [x] 步骤1：环境准备（已完成）
  - [x] 安装 Supabase 依赖
  - [x] 更新配色方案（汽车行业专业风格）
  - [x] 创建类型定义文件
- [x] 步骤2：数据库设计与初始化（已完成）
  - [x] 初始化 Supabase
  - [x] 创建数据库表结构（员工、车辆、销售、费用、利润分配等）
  - [x] 创建存储桶（车辆照片）
  - [x] 设置 RLS 策略
  - [x] 创建辅助函数和视图
- [x] 步骤3：认证系统（已完成）
  - [x] 创建 AuthContext
  - [x] 创建 RouteGuard
  - [x] 创建登录页面
  - [x] 更新 App.tsx 集成认证
- [x] 步骤4：数据库 API 封装（已完成）
  - [x] 创建 Supabase 客户端
  - [x] 封装员工相关 API
  - [x] 封装车辆相关 API
  - [x] 封装销售相关 API
  - [x] 封装费用和利润分配 API
- [x] 步骤5：布局和导航（已完成）
  - [x] 创建管理后台布局（带侧边栏）
  - [x] 创建手机端布局
  - [x] 更新路由配置
- [x] 步骤6：核心功能页面（已完成）
  - [x] Dashboard - 仪表盘
  - [x] Employees - 员工管理
  - [x] Vehicles - 车辆管理
  - [x] Sales - 销售管理（基础版）
  - [x] Expenses - 费用管理（基础版）
  - [x] Profits - 利润分配（基础版）
  - [x] Statistics - 统计分析（基础版）
- [x] 步骤7：手机端展示（已完成）
  - [x] CustomerView - 客户端车辆展示
  - [x] InternalReport - 内部通报（基础版）
- [x] 步骤8：管理员功能（已完成）
  - [x] Admin - 用户管理页面
- [x] 步骤9：图片上传组件（已完成）
  - [x] ImageUpload - 车辆照片上传组件
- [x] 步骤10：权限系统优化（已完成）
  - [x] 更新数据库 RLS 策略
  - [x] 员工可录入新数据，不可修改已有数据
  - [x] 管理员拥有最高权限
  - [x] 前端权限控制和UI提示
- [x] 步骤11：测试和优化（已完成）
  - [x] 运行 lint 检查
  - [x] 修复所有错误

## 完成情况
✅ 所有核心功能已实现
✅ 数据库结构完整
✅ 认证系统正常工作
✅ 图片上传功能完整
✅ 权限系统已优化
✅ Lint 检查通过

## 权限说明
### 员工权限
- ✅ 可以录入新车辆
- ✅ 可以添加车辆成本
- ✅ 可以创建销售记录
- ✅ 可以创建费用记录
- ✅ 可以上传车辆图片
- ❌ 不能修改已有车辆信息
- ❌ 不能修改已有成本记录
- ❌ 不能修改已有销售记录
- ❌ 不能修改已有费用记录
- ❌ 不能删除任何数据
- ❌ 不能管理员工信息
- ❌ 不能编辑员工角色

### 管理员权限
- ✅ 拥有所有员工权限
- ✅ 可以修改所有数据
- ✅ 可以删除数据
- ✅ 可以管理员工信息
- ✅ 可以编辑员工角色
- ✅ 可以管理用户权限
- ✅ 可以更新和删除车辆图片

## 注意事项
- 配色方案：深蓝色主色调（专业、可信赖），橙色强调色（活力）
- 利润分配规则：地租18%、月奖金池10%、销售提成36%、押车出资人36%
- 车辆唯一标识：车架号后六位
- 支持多角色：一人多角色，多人一角色
- 月度销售冠军获得奖金池剩余金额
- 第一个注册的用户自动成为管理员

## 使用说明
1. 首次使用请先注册账号，第一个注册的用户自动成为管理员
2. 管理员可以在"用户管理"页面设置其他用户的角色
3. 管理员在"员工管理"页面添加员工信息并分配角色
4. 员工可以在"车辆管理"页面进行车辆入库，支持上传照片
5. 员工录入的数据只有管理员可以修改
6. 客户展示页面（/customer-view）无需登录即可访问
