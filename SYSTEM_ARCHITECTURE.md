# äºŒæ‰‹è½¦é”€å”®ç®¡ç†ç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

**ç‰ˆæœ¬**ï¼šv2.0  
**æœ€åæ›´æ–°**ï¼š2026-01-19  
**ç»´æŠ¤è€…**ï¼šå¼€å‘å›¢é˜Ÿ

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†äºŒæ‰‹è½¦é”€å”®ç®¡ç†ç³»ç»Ÿçš„æ•´ä½“æ¶æ„ã€æŠ€æœ¯é€‰å‹ã€æ¨¡å—åˆ’åˆ†å’Œæ•°æ®æµå‘ã€‚

---

## ğŸ¯ ç³»ç»Ÿå®šä½

### æ ¸å¿ƒä»·å€¼

**äºŒæ‰‹è½¦é”€å”®ç®¡ç†ç³»ç»Ÿ**æ˜¯ä¸€æ¬¾é¢å‘äºŒæ‰‹è½¦è¡Œçš„SaaSå¹³å°ï¼Œæä¾›ï¼š
- è½¦è¾†å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆå…¥åº“â†’åœ¨å”®â†’å·²å”®ï¼‰
- é”€å”®ä¸šç»©å’Œåˆ©æ¶¦åˆ†é…è®¡ç®—
- å¤šè½¦è¡Œç®¡ç†å’Œä¼šå‘˜åˆ¶åº¦
- ç§»åŠ¨ç«¯å±•ç¤ºå’Œå†…éƒ¨é€šæŠ¥

### ç›®æ ‡ç”¨æˆ·

1. **è½¦è¡Œç®¡ç†å‘˜**ï¼šç®¡ç†è½¦è¾†ã€å‘˜å·¥ã€é”€å”®ã€è´¢åŠ¡
2. **è½¦è¡Œå‘˜å·¥**ï¼šå½•å…¥è½¦è¾†ã€æŸ¥çœ‹ä¸šç»©ã€æ¥æ”¶é€šæŠ¥
3. **å¹³å°ç®¡ç†å‘˜**ï¼šç®¡ç†æ‰€æœ‰è½¦è¡Œã€ä¼šå‘˜ã€ç³»ç»Ÿé…ç½®
4. **å®¢æˆ·**ï¼šæµè§ˆåœ¨å”®è½¦è¾†ã€é¢„çº¦çœ‹è½¦

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å®¢æˆ·ç«¯å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Webæµè§ˆå™¨  â”‚  ç§»åŠ¨æµè§ˆå™¨  â”‚  PWAåº”ç”¨  â”‚  åŸç”ŸAPP(å¯é€‰)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React 18.3  â”‚  TypeScript  â”‚  Vite  â”‚  Tailwind CSS        â”‚
â”‚  shadcn/ui   â”‚  React Router â”‚  React Hook Form  â”‚  Zod     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APIå±‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Supabase Client  â”‚  RESTful API  â”‚  Edge Functions         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         åç«¯å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Supabase Auth  â”‚  PostgreSQL  â”‚  RLS  â”‚  Triggers  â”‚  RPC  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å­˜å‚¨å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL Database  â”‚  Supabase Storage  â”‚  Edge Cache    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | å®˜ç½‘ |
|------|------|------|------|
| React | 18.3.1 | UIæ¡†æ¶ | https://react.dev/ |
| TypeScript | 5.6.2 | ç±»å‹ç³»ç»Ÿ | https://www.typescriptlang.org/ |
| Vite | 5.4.20 | æ„å»ºå·¥å…· | https://vitejs.dev/ |
| React Router | 6.28.0 | è·¯ç”±ç®¡ç† | https://reactrouter.com/ |
| Tailwind CSS | 3.4.15 | CSSæ¡†æ¶ | https://tailwindcss.com/ |
| shadcn/ui | latest | UIç»„ä»¶åº“ | https://ui.shadcn.com/ |
| React Hook Form | 7.54.0 | è¡¨å•ç®¡ç† | https://react-hook-form.com/ |
| Zod | 3.23.8 | æ•°æ®éªŒè¯ | https://zod.dev/ |
| Recharts | 2.14.1 | å›¾è¡¨åº“ | https://recharts.org/ |
| Lucide React | 0.468.0 | å›¾æ ‡åº“ | https://lucide.dev/ |
| Sonner | 1.7.1 | Toasté€šçŸ¥ | https://sonner.emilkowal.ski/ |

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | å®˜ç½‘ |
|------|------|------|------|
| Supabase | 2.46.2 | BaaSå¹³å° | https://supabase.com/ |
| PostgreSQL | 15+ | æ•°æ®åº“ | https://www.postgresql.org/ |
| PostgREST | - | RESTful API | https://postgrest.org/ |
| Deno | 1.40+ | Edge Functionsè¿è¡Œæ—¶ | https://deno.land/ |

### å¼€å‘å·¥å…·

| å·¥å…· | ç”¨é€” |
|------|------|
| Biome | ä»£ç æ ¼å¼åŒ–å’ŒLint |
| Git | ç‰ˆæœ¬æ§åˆ¶ |
| pnpm | åŒ…ç®¡ç†å™¨ |
| VS Code | å¼€å‘IDE |

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
app-8u0242wc45c1/
â”œâ”€â”€ public/                      # é™æ€èµ„æº
â”‚   â”œâ”€â”€ icon-192.png            # PWAå›¾æ ‡
â”‚   â”œâ”€â”€ icon-512.png
â”‚   â””â”€â”€ manifest.json           # PWAé…ç½®
â”œâ”€â”€ src/                         # æºä»£ç 
â”‚   â”œâ”€â”€ components/             # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ common/             # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ PageWrapper.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUpload.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ layouts/            # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Header.tsx
â”‚   â”‚   â””â”€â”€ ui/                 # shadcn/uiç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚       â”œâ”€â”€ card.tsx
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ context/                # React Context
â”‚   â”‚   â””â”€â”€ AuthContext.tsx    # è®¤è¯ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ db/                     # æ•°æ®åº“API
â”‚   â”‚   â”œâ”€â”€ supabase.ts        # Supabaseå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ api.ts             # é€šç”¨API
â”‚   â”‚   â”œâ”€â”€ membershipApi.ts   # ä¼šå‘˜API
â”‚   â”‚   â”œâ”€â”€ paymentApi.ts      # æ”¯ä»˜API
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ use-toast.ts
â”‚   â”‚   â””â”€â”€ use-mobile.tsx
â”‚   â”œâ”€â”€ lib/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”œâ”€â”€ pages/                  # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx      # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ Vehicles.tsx       # è½¦è¾†ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ Sales.tsx          # é”€å”®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ Employees.tsx      # å‘˜å·¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ MembershipCenter.tsx # ä¼šå‘˜ä¸­å¿ƒ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ types/                  # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ types.ts           # é€šç”¨ç±»å‹
â”‚   â”‚   â””â”€â”€ vehicleEnums.ts    # è½¦è¾†æšä¸¾
â”‚   â”œâ”€â”€ App.tsx                 # åº”ç”¨æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ main.tsx               # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ routes.tsx             # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ index.css              # å…¨å±€æ ·å¼
â”œâ”€â”€ supabase/                   # Supabaseé…ç½®
â”‚   â”œâ”€â”€ functions/             # Edge Functions
â”‚   â”‚   â”œâ”€â”€ wechat-pay/
â”‚   â”‚   â”œâ”€â”€ alipay/
â”‚   â”‚   â””â”€â”€ payment-webhook/
â”‚   â””â”€â”€ migrations/            # æ•°æ®åº“è¿ç§»
â”‚       â”œâ”€â”€ 00001_initial_schema.sql
â”‚       â”œâ”€â”€ 00002_add_rls_policies.sql
â”‚       â””â”€â”€ ...
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ package.json               # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json              # TypeScripté…ç½®
â”œâ”€â”€ tailwind.config.js         # Tailwindé…ç½®
â”œâ”€â”€ vite.config.ts             # Viteé…ç½®
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

---

## ğŸ”„ æ•°æ®æµå‘

### 1. ç”¨æˆ·è®¤è¯æµç¨‹

```
ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç 
    â†“
å‰ç«¯éªŒè¯è¡¨å•
    â†“
è°ƒç”¨ Supabase Auth API
    â†“
éªŒè¯ç”¨æˆ·å‡­è¯
    â†“
è¿”å› JWT Token
    â†“
å­˜å‚¨åˆ° LocalStorage
    â†“
æŸ¥è¯¢ç”¨æˆ·Profile
    â†“
è®¾ç½® AuthContext
    â†“
é‡å®šå‘åˆ°ä»ªè¡¨ç›˜
```

### 2. æ•°æ®æŸ¥è¯¢æµç¨‹

```
ç”¨æˆ·è®¿é—®é¡µé¢
    â†“
ç»„ä»¶ useEffect è§¦å‘
    â†“
è°ƒç”¨ API å‡½æ•° (å¦‚ vehiclesApi.getAll())
    â†“
Supabase Client å‘èµ·è¯·æ±‚
    â†“
PostgreSQL æ‰§è¡ŒæŸ¥è¯¢
    â†“
RLS ç­–ç•¥éªŒè¯æƒé™
    â†“
è¿”å›æ•°æ®
    â†“
ç»„ä»¶æ›´æ–°çŠ¶æ€
    â†“
UI é‡æ–°æ¸²æŸ“
```

### 3. æ•°æ®ä¿®æ”¹æµç¨‹

```
ç”¨æˆ·æäº¤è¡¨å•
    â†“
å‰ç«¯éªŒè¯ (Zod Schema)
    â†“
è°ƒç”¨ API å‡½æ•° (å¦‚ vehiclesApi.create())
    â†“
Supabase Client å‘èµ·è¯·æ±‚
    â†“
PostgreSQL æ‰§è¡Œ INSERT/UPDATE
    â†“
è§¦å‘å™¨æ‰§è¡Œ (å¦‚æ£€æŸ¥è½¦è¾†æ•°é‡é™åˆ¶)
    â†“
RLS ç­–ç•¥éªŒè¯æƒé™
    â†“
è¿”å›ç»“æœ
    â†“
æ˜¾ç¤º Toast é€šçŸ¥
    â†“
åˆ·æ–°æ•°æ®
```

### 4. æ”¯ä»˜æµç¨‹

```
ç”¨æˆ·é€‰æ‹©ä¼šå‘˜ç­‰çº§
    â†“
åˆ›å»ºæ”¯ä»˜è®¢å• (payment_orders)
    â†“
è°ƒç”¨ Edge Function (wechat-pay)
    â†“
è°ƒç”¨å¾®ä¿¡æ”¯ä»˜API
    â†“
è¿”å›äºŒç»´ç 
    â†“
ç”¨æˆ·æ‰«ç æ”¯ä»˜
    â†“
å¾®ä¿¡æ”¯ä»˜å›è°ƒ (wechat-pay-notify)
    â†“
éªŒè¯ç­¾å
    â†“
æ›´æ–°è®¢å•çŠ¶æ€
    â†“
åˆ›å»ºä¼šå‘˜è®°å½•
    â†“
å‰ç«¯è½®è¯¢æ£€æµ‹åˆ°æ”¯ä»˜æˆåŠŸ
    â†“
æ˜¾ç¤ºæˆåŠŸæç¤º
    â†“
åˆ·æ–°ä¼šå‘˜ä¿¡æ¯
```

---

## ğŸ§© æ¨¡å—åˆ’åˆ†

### æ ¸å¿ƒæ¨¡å—

#### 1. è®¤è¯æ¨¡å— (Auth)

**èŒè´£**ï¼š
- ç”¨æˆ·ç™»å½•/æ³¨å†Œ
- ä¼šè¯ç®¡ç†
- æƒé™éªŒè¯

**å…³é”®æ–‡ä»¶**ï¼š
- `src/context/AuthContext.tsx`
- `src/pages/Login.tsx`
- `src/pages/DealershipRegister.tsx`

**æ•°æ®è¡¨**ï¼š
- `auth.users` (Supabaseå†…ç½®)
- `profiles`
- `dealerships`

---

#### 2. è½¦è¾†ç®¡ç†æ¨¡å— (Vehicles)

**èŒè´£**ï¼š
- è½¦è¾†å…¥åº“
- è½¦è¾†ä¿¡æ¯ç®¡ç†
- è½¦è¾†çŠ¶æ€è·Ÿè¸ª
- è½¦è¾†ç…§ç‰‡ä¸Šä¼ 

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Vehicles.tsx`
- `src/db/api.ts` (vehiclesApi)
- `src/components/common/ImageUpload.tsx`

**æ•°æ®è¡¨**ï¼š
- `vehicles`
- `vehicle_costs`
- `vehicle_images`

**ä¸šåŠ¡è§„åˆ™**ï¼š
- è½¦æ¶å·åå…­ä½å”¯ä¸€æ ‡è¯†
- çŠ¶æ€ï¼šin_stockï¼ˆåœ¨å”®ï¼‰ã€soldï¼ˆå·²å”®ï¼‰ã€reservedï¼ˆé¢„ç•™ï¼‰
- æˆæœ¬åŒ…æ‹¬ï¼šè´­è½¦æ¬¾ã€æ•´å¤‡è´¹ã€è¿‡æˆ·è´¹ã€æ‚è´¹
- å—ä¼šå‘˜ç­‰çº§è½¦è¾†æ•°é‡é™åˆ¶

---

#### 3. é”€å”®ç®¡ç†æ¨¡å— (Sales)

**èŒè´£**ï¼š
- é”€å”®è®°å½•
- åˆ©æ¶¦è®¡ç®—
- é”€å”®å‘˜å·¥å…³è”
- è´·æ¬¾è¿”åˆ©ç®¡ç†

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Sales.tsx`
- `src/db/api.ts` (salesApi)

**æ•°æ®è¡¨**ï¼š
- `sales`
- `sale_costs`
- `loan_rebates`

**ä¸šåŠ¡è§„åˆ™**ï¼š
- æ€»åˆ©æ¶¦ = æˆäº¤ä»· - æ€»æˆæœ¬ + è´·æ¬¾è¿”åˆ©
- åˆ©æ¶¦åˆ†é…ï¼šåœ°ç§Ÿ18%ã€æœˆå¥–é‡‘æ± 10%ã€é”€å”®ææˆ36%ã€æŠ¼è½¦å‡ºèµ„äºº36%
- æœˆå¥–é‡‘æ± å‰©ä½™åˆ†é…ç»™æœˆé”€å”®å† å†›

---

#### 4. å‘˜å·¥ç®¡ç†æ¨¡å— (Employees)

**èŒè´£**ï¼š
- å‘˜å·¥ä¿¡æ¯ç®¡ç†
- è§’è‰²åˆ†é…
- ä¸šç»©ç»Ÿè®¡

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Employees.tsx`
- `src/db/api.ts` (profilesApi)

**æ•°æ®è¡¨**ï¼š
- `profiles`
- `profit_roles`

**ä¸šåŠ¡è§„åˆ™**ï¼š
- è§’è‰²ï¼šåœ°ç§Ÿã€æœˆå¥–é‡‘æ± ã€é”€å”®ææˆã€æŠ¼è½¦å‡ºèµ„äºº
- æ”¯æŒä¸€äººå¤šè§’è‰²ã€å¤šäººä¸€è§’è‰²
- ä¸šç»©æŒ‰å®ç°åˆ©æ¶¦è¯„å®š

---

#### 5. è´¹ç”¨ç®¡ç†æ¨¡å— (Expenses)

**èŒè´£**ï¼š
- è¿è¥è´¹ç”¨è®°å½•
- è´¹ç”¨åˆ†ç±»
- è´¹ç”¨ç»Ÿè®¡

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Expenses.tsx`
- `src/db/api.ts` (expensesApi)

**æ•°æ®è¡¨**ï¼š
- `expenses`

---

#### 6. åˆ©æ¶¦åˆ†é…æ¨¡å— (Profits)

**èŒè´£**ï¼š
- åˆ©æ¶¦è®¡ç®—
- åˆ©æ¶¦åˆ†é…
- åˆ†é…è§„åˆ™ç®¡ç†

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Profits.tsx`
- `src/pages/ProfitRules.tsx`
- `src/db/api.ts` (profitsApi)

**æ•°æ®è¡¨**ï¼š
- `profit_distributions`
- `profit_rules`

---

#### 7. ç»Ÿè®¡åˆ†ææ¨¡å— (Statistics)

**èŒè´£**ï¼š
- æœˆåº¦é”€å”®ç»Ÿè®¡
- å‘˜å·¥æ’è¡Œ
- åˆ©æ¶¦åˆ†æ
- è¶‹åŠ¿å›¾è¡¨

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Statistics.tsx`
- `src/pages/Dashboard.tsx`

**æ•°æ®è¡¨**ï¼š
- èšåˆæŸ¥è¯¢å¤šä¸ªè¡¨

---

#### 8. ä¼šå‘˜ç®¡ç†æ¨¡å— (Membership)

**èŒè´£**ï¼š
- ä¼šå‘˜ç­‰çº§ç®¡ç†
- ä¼šå‘˜å¼€é€š/ç»­è´¹
- è½¦è¾†æ•°é‡é™åˆ¶
- ä¼šå‘˜å‡çº§

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/MembershipCenter.tsx`
- `src/pages/PlatformMembershipManagement.tsx`
- `src/db/membershipApi.ts`

**æ•°æ®è¡¨**ï¼š
- `membership_tiers`
- `dealership_memberships`
- `membership_payments`

**ä¸šåŠ¡è§„åˆ™**ï¼š
- å››ä¸ªä¼šå‘˜ç­‰çº§ï¼šä¸€çº§(1-10å°)ã€äºŒçº§(11-30å°)ã€ä¸‰çº§(31-50å°)ã€å››çº§(51+å°)
- 6ä¸ªæœˆå…è´¹æœŸ
- è½¦è¾†æ•°é‡è¶…é™é˜»æ­¢æ·»åŠ 

---

#### 9. æ”¯ä»˜æ¨¡å— (Payment)

**èŒè´£**ï¼š
- æ”¯ä»˜è®¢å•åˆ›å»º
- æ”¯ä»˜çŠ¶æ€æŸ¥è¯¢
- æ”¯ä»˜å›è°ƒå¤„ç†
- æ”¯ä»˜å†å²è®°å½•

**å…³é”®æ–‡ä»¶**ï¼š
- `src/db/paymentApi.ts`
- `supabase/functions/wechat-pay/`
- `supabase/functions/alipay/`
- `supabase/functions/payment-webhook/`

**æ•°æ®è¡¨**ï¼š
- `payment_orders`
- `membership_payments`

---

#### 10. å®¢æˆ·å±•ç¤ºæ¨¡å— (Public)

**èŒè´£**ï¼š
- åœ¨å”®è½¦è¾†å±•ç¤º
- è½¦è¾†è¯¦æƒ…æŸ¥çœ‹
- é¢„çº¦çœ‹è½¦
- è”ç³»è½¦è¡Œ

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/PublicHome.tsx`
- `src/pages/CustomerView.tsx`
- `src/pages/CarDetail.tsx`

**æ•°æ®è¡¨**ï¼š
- `vehicles` (status='in_stock')
- `dealerships`

---

#### 11. å†…éƒ¨é€šæŠ¥æ¨¡å— (Internal Report)

**èŒè´£**ï¼š
- æ¯æ—¥é”€å”®é€šæŠ¥
- æœˆåº¦é”€å”®é€šæŠ¥
- ä¸ªäººä¸šç»©
- å›¢é˜Ÿä¸šç»©

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/InternalReport.tsx`

**æ•°æ®è¡¨**ï¼š
- `sales`
- `profit_distributions`

---

#### 12. å¹³å°ç®¡ç†æ¨¡å— (Platform)

**èŒè´£**ï¼š
- è½¦è¡Œç®¡ç†
- å¹³å°å‘˜å·¥ç®¡ç†
- ä¼šå‘˜ç®¡ç†
- ç³»ç»Ÿé…ç½®

**å…³é”®æ–‡ä»¶**ï¼š
- `src/pages/Dealerships.tsx`
- `src/pages/PlatformEmployees.tsx`
- `src/pages/PlatformMembershipManagement.tsx`
- `src/pages/PlatformSettings.tsx`

**æ•°æ®è¡¨**ï¼š
- `dealerships`
- `profiles` (role='super_admin')
- `dealership_memberships`

---

## ğŸ” å®‰å…¨æ¶æ„

### è®¤è¯æœºåˆ¶

**Supabase Auth**ï¼š
- JWT Tokenè®¤è¯
- è‡ªåŠ¨åˆ·æ–°Token
- ä¼šè¯ç®¡ç†

**å®ç°**ï¼š
```typescript
// ç™»å½•
const { data, error } = await supabase.auth.signInWithPassword({
  email,
  password
});

// è·å–å½“å‰ç”¨æˆ·
const { data: { user } } = await supabase.auth.getUser();

// ç™»å‡º
await supabase.auth.signOut();
```

---

### æƒé™æ§åˆ¶

**RLS (Row Level Security)**ï¼š
- è¡¨çº§æƒé™æ§åˆ¶
- åŸºäºç”¨æˆ·è§’è‰²
- è‡ªåŠ¨åº”ç”¨äºæ‰€æœ‰æŸ¥è¯¢

**è§’è‰²å®šä¹‰**ï¼š
```sql
CREATE TYPE user_role AS ENUM (
  'super_admin',  -- å¹³å°ç®¡ç†å‘˜
  'admin',        -- è½¦è¡Œç®¡ç†å‘˜
  'employee'      -- è½¦è¡Œå‘˜å·¥
);
```

**æƒé™çŸ©é˜µ**ï¼š

| èµ„æº | super_admin | admin | employee |
|------|-------------|-------|----------|
| æ‰€æœ‰è½¦è¡Œæ•°æ® | âœ… | âŒ | âŒ |
| è‡ªå·±è½¦è¡Œæ•°æ® | âœ… | âœ… | âœ… (åªè¯») |
| è½¦è¾†ç®¡ç† | âœ… | âœ… | âœ… (æ–°å¢) |
| é”€å”®ç®¡ç† | âœ… | âœ… | âŒ |
| å‘˜å·¥ç®¡ç† | âœ… | âœ… | âŒ |
| è´¢åŠ¡ç®¡ç† | âœ… | âœ… | âŒ |
| ä¼šå‘˜ç®¡ç† | âœ… | âœ… (è‡ªå·±è½¦è¡Œ) | âŒ |
| å¹³å°ç®¡ç† | âœ… | âŒ | âŒ |

---

### æ•°æ®éš”ç¦»

**è½¦è¡Œæ•°æ®éš”ç¦»**ï¼š
```sql
-- ç¤ºä¾‹ï¼šè½¦è¾†è¡¨RLSç­–ç•¥
CREATE POLICY "ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±è½¦è¡Œçš„è½¦è¾†"
  ON vehicles FOR SELECT
  USING (
    dealership_id IN (
      SELECT dealership_id FROM profiles WHERE id = auth.uid()
    )
  );
```

**è·¨è½¦è¡ŒæŸ¥è¯¢é™åˆ¶**ï¼š
- æ™®é€šç”¨æˆ·æ— æ³•æŸ¥è¯¢å…¶ä»–è½¦è¡Œæ•°æ®
- å¹³å°ç®¡ç†å‘˜å¯ä»¥æŸ¥è¯¢æ‰€æœ‰æ•°æ®
- ä½¿ç”¨ `dealership_id` å­—æ®µéš”ç¦»

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–

**ä»£ç åˆ†å‰²**ï¼š
```typescript
// è·¯ç”±æ‡’åŠ è½½
const Dashboard = lazy(() => import('./pages/Dashboard'));
const Vehicles = lazy(() => import('./pages/Vehicles'));
```

**å›¾ç‰‡ä¼˜åŒ–**ï¼š
```typescript
// æ‡’åŠ è½½
<img loading="lazy" src={imageUrl} alt="è½¦è¾†å›¾ç‰‡" />

// å‹ç¼©ä¸Šä¼ 
const compressedImage = await compressImage(file, {
  maxWidth: 1920,
  maxHeight: 1080,
  quality: 0.8
});
```

**ç¼“å­˜ç­–ç•¥**ï¼š
```typescript
// React Queryç¼“å­˜
const { data } = useQuery({
  queryKey: ['vehicles'],
  queryFn: vehiclesApi.getAll,
  staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿ
});
```

---

### åç«¯ä¼˜åŒ–

**æ•°æ®åº“ç´¢å¼•**ï¼š
```sql
-- è½¦è¾†æŸ¥è¯¢ç´¢å¼•
CREATE INDEX idx_vehicles_dealership_status 
  ON vehicles(dealership_id, status);

-- é”€å”®æŸ¥è¯¢ç´¢å¼•
CREATE INDEX idx_sales_dealership_date 
  ON sales(dealership_id, sale_date DESC);
```

**æŸ¥è¯¢ä¼˜åŒ–**ï¼š
```typescript
// åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
const { data } = await supabase
  .from('vehicles')
  .select('id, vin_last_six, brand, model, price')
  .eq('status', 'in_stock');

// ä½¿ç”¨åˆ†é¡µ
const { data } = await supabase
  .from('vehicles')
  .select('*')
  .range(0, 9); // æ¯é¡µ10æ¡
```

**RPCå‡½æ•°**ï¼š
```sql
-- å¤æ‚æŸ¥è¯¢ä½¿ç”¨RPC
CREATE FUNCTION get_monthly_sales_stats(p_dealership_id UUID)
RETURNS JSON AS $$
  -- å¤æ‚çš„èšåˆæŸ¥è¯¢
$$ LANGUAGE sql STABLE;
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç›‘æ§

**å…³é”®æŒ‡æ ‡**ï¼š
- é¡µé¢åŠ è½½æ—¶é—´
- APIå“åº”æ—¶é—´
- é”™è¯¯ç‡
- ç”¨æˆ·æ´»è·ƒåº¦

**å·¥å…·**ï¼š
- Supabase Dashboardï¼ˆå†…ç½®ç›‘æ§ï¼‰
- Browser DevTools
- Sentryï¼ˆå¯é€‰ï¼‰

---

### æ—¥å¿—è®°å½•

**å‰ç«¯æ—¥å¿—**ï¼š
```typescript
// é”™è¯¯æ—¥å¿—
console.error('åŠ è½½è½¦è¾†å¤±è´¥:', error);

// ä¸šåŠ¡æ—¥å¿—
console.log('ç”¨æˆ·ç™»å½•:', user.email);
```

**åç«¯æ—¥å¿—**ï¼š
```typescript
// Edge Functionæ—¥å¿—
console.log('æ”¯ä»˜å›è°ƒ:', notification);
console.error('ç­¾åéªŒè¯å¤±è´¥:', error);
```

**æ•°æ®åº“æ—¥å¿—**ï¼š
```sql
-- åˆ›å»ºæ—¥å¿—è¡¨
CREATE TABLE audit_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id),
  action TEXT NOT NULL,
  table_name TEXT NOT NULL,
  record_id UUID,
  old_data JSONB,
  new_data JSONB,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- è§¦å‘å™¨è®°å½•å˜æ›´
CREATE TRIGGER audit_vehicles_changes
  AFTER INSERT OR UPDATE OR DELETE ON vehicles
  FOR EACH ROW EXECUTE FUNCTION log_changes();
```

---

## ğŸ”„ æ‰©å±•æ€§è®¾è®¡

### æ°´å¹³æ‰©å±•

**Supabaseè‡ªåŠ¨æ‰©å±•**ï¼š
- æ•°æ®åº“è¿æ¥æ± 
- è‡ªåŠ¨è´Ÿè½½å‡è¡¡
- CDNåŠ é€Ÿ

**å‰ç«¯æ‰©å±•**ï¼š
- é™æ€èµ„æºCDN
- å¤šåœ°åŸŸéƒ¨ç½²
- PWAç¦»çº¿æ”¯æŒ

---

### åŠŸèƒ½æ‰©å±•

**æ’ä»¶åŒ–è®¾è®¡**ï¼š
```typescript
// æ”¯ä»˜æ’ä»¶æ¥å£
interface PaymentProvider {
  createOrder(params: OrderParams): Promise<Order>;
  queryOrder(orderNo: string): Promise<OrderStatus>;
  closeOrder(orderNo: string): Promise<void>;
}

// å¾®ä¿¡æ”¯ä»˜å®ç°
class WechatPayProvider implements PaymentProvider {
  // å®ç°æ¥å£
}

// æ”¯ä»˜å®å®ç°
class AlipayProvider implements PaymentProvider {
  // å®ç°æ¥å£
}
```

**æ¨¡å—åŒ–è®¾è®¡**ï¼š
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹
- é€šè¿‡APIé€šä¿¡
- æ˜“äºæ·»åŠ æ–°åŠŸèƒ½

---

## ğŸ“ å¼€å‘æµç¨‹

### 1. éœ€æ±‚åˆ†æ

- æ”¶é›†ç”¨æˆ·éœ€æ±‚
- ç¼–å†™éœ€æ±‚æ–‡æ¡£
- è¯„å®¡éœ€æ±‚

### 2. è®¾è®¡é˜¶æ®µ

- æ•°æ®åº“è®¾è®¡
- APIè®¾è®¡
- UI/UXè®¾è®¡
- æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡

### 3. å¼€å‘é˜¶æ®µ

- åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
- ç¼–å†™ä»£ç 
- å•å…ƒæµ‹è¯•
- ä»£ç å®¡æŸ¥

### 4. æµ‹è¯•é˜¶æ®µ

- åŠŸèƒ½æµ‹è¯•
- é›†æˆæµ‹è¯•
- æ€§èƒ½æµ‹è¯•
- å®‰å…¨æµ‹è¯•

### 5. éƒ¨ç½²ä¸Šçº¿

- åˆå¹¶åˆ°ä¸»åˆ†æ”¯
- éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- ç›‘æ§è¿è¡ŒçŠ¶æ€
- æ”¶é›†ç”¨æˆ·åé¦ˆ

### 6. ç»´æŠ¤è¿­ä»£

- ä¿®å¤Bug
- ä¼˜åŒ–æ€§èƒ½
- æ·»åŠ æ–°åŠŸèƒ½
- ç‰ˆæœ¬å‡çº§

---

## ğŸ¯ æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡ï¼ˆ3ä¸ªæœˆï¼‰

- âœ… å®Œå–„ä¼šå‘˜åˆ¶åº¦
- âœ… é›†æˆçº¿ä¸Šæ”¯ä»˜
- âœ… ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ
- â³ æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
- â³ å®ç°æ¶ˆæ¯æ¨é€

### ä¸­æœŸç›®æ ‡ï¼ˆ6ä¸ªæœˆï¼‰

- â³ å¼€å‘å°ç¨‹åºç‰ˆæœ¬
- â³ æ·»åŠ å®¢æˆ·ç®¡ç†CRM
- â³ å®ç°åº“å­˜é¢„è­¦
- â³ æ·»åŠ è´¢åŠ¡æŠ¥è¡¨

### é•¿æœŸç›®æ ‡ï¼ˆ1å¹´ï¼‰

- â³ å¼€å‘åŸç”ŸAPP
- â³ æ¥å…¥ç¬¬ä¸‰æ–¹è½¦æº
- â³ å®ç°æ™ºèƒ½å®šä»·
- â³ æ·»åŠ AIå®¢æœ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](./DATABASE_DESIGN.md)
- [å‰ç«¯å¼€å‘è§„èŒƒ](./FRONTEND_GUIDELINES.md)
- [åç«¯å¼€å‘è§„èŒƒ](./BACKEND_GUIDELINES.md)
- [ä¸šåŠ¡æµç¨‹æ–‡æ¡£](./BUSINESS_PROCESSES.md)
- [ä»£ç è§„èŒƒæ–‡æ¡£](./CODE_STANDARDS.md)
- [éƒ¨ç½²è¿ç»´æŒ‡å—](./DEPLOYMENT_GUIDE.md)

---

**æ–‡æ¡£ç»´æŠ¤**ï¼š
- æ¯æ¬¡é‡å¤§æ›´æ–°åæ›´æ–°æ–‡æ¡£
- å®šæœŸå®¡æŸ¥æ–‡æ¡£å‡†ç¡®æ€§
- æ¬¢è¿å›¢é˜Ÿæˆå‘˜è´¡çŒ®

**è”ç³»æ–¹å¼**ï¼š
- æŠ€æœ¯æ”¯æŒï¼štech@example.com
- é—®é¢˜åé¦ˆï¼šissues@example.com
