# 测试车行登录指南

## 🔐 登录方式

由于测试车行的管理员账号需要通过Supabase Auth创建，目前有以下几种方式访问测试车行数据：

---

## 方式一：使用平台管理员账号查看（推荐用于测试）

### 登录信息
- **邮箱**：`wh@yichi.internal`
- **密码**：`123456`
- **角色**：超级管理员

### 操作步骤

#### 1. 登录系统
1. 打开登录页面
2. 输入邮箱：`wh@yichi.internal`
3. 输入密码：`123456`
4. 点击"登录"

#### 2. 进入平台管理后台
1. 登录成功后，系统会自动识别超级管理员身份
2. 左侧菜单显示"平台管理"相关菜单

#### 3. 查看测试车行
1. 点击左侧菜单"车行管理"
2. 在车行列表中可以看到三个测试车行：
   - 鸿运二手车（深圳市）
   - 顺达汽车（杭州市）
   - 盛世车行（南京市）

#### 4. 查看会员状态
1. 点击左侧菜单"会员管理"
2. 查看三个测试车行的会员状态：
   - 鸿运二手车：已续费会员，剩余300天
   - 顺达汽车：免费期会员，剩余150天
   - 盛世车行：免费期即将到期，剩余5天

#### 5. 测试续费功能
1. 在会员管理页面选择"盛世车行"
2. 点击"续费"按钮
3. 填写续费信息并确认
4. 验证续费成功

**注意**：平台管理员只能查看和管理车行数据，无法以车行管理员身份登录车行管理系统。

---

## 方式二：通过车行注册流程创建管理员账号

### 步骤1：访问注册页面

1. 打开系统首页
2. 点击"注册"或访问 `/register` 路径

### 步骤2：填写车行注册信息

#### 为鸿运二手车注册管理员
1. 填写车行信息：
   - 车行名称：鸿运二手车（已存在，需要使用不同名称或修改现有记录）
   - 车行代码：hongyun
   - 省份：广东省
   - 城市：深圳市
   - 区县：南山区
   - 联系人：张经理
   - 联系电话：13900000001
2. 填写管理员账号信息：
   - 用户名：张经理
   - 邮箱：zhangsan@hongyun.com
   - 密码：123456
3. 提交注册
4. 等待平台管理员审核通过

**问题**：由于车行已经存在，需要先删除现有车行记录，或者使用不同的车行名称。

---

## 方式三：使用Supabase Dashboard创建Auth用户（推荐）

### 前提条件
- 需要有Supabase项目的访问权限
- 需要登录Supabase Dashboard

### 步骤1：登录Supabase Dashboard

1. 访问 Supabase Dashboard
2. 选择对应的项目

### 步骤2：创建Auth用户

#### 为鸿运二手车创建管理员

1. 进入 Authentication → Users
2. 点击 "Add user" 或 "Invite user"
3. 填写信息：
   - Email: `zhangsan@hongyun.com`
   - Password: `123456`
   - Auto Confirm User: ✅ 勾选（跳过邮箱验证）
4. 点击 "Create user"
5. 记录创建的用户ID（例如：`a1b2c3d4-e5f6-7890-abcd-ef1234567890`）

### 步骤3：创建Profile记录

在Supabase SQL Editor中执行：

```sql
-- 为鸿运二手车创建管理员profile
INSERT INTO profiles (
  id,
  username,
  email,
  phone,
  role,
  dealership_id,
  status,
  default_password
) VALUES (
  'a1b2c3d4-e5f6-7890-abcd-ef1234567890', -- 替换为实际的auth用户ID
  '张经理',
  'zhangsan@hongyun.com',
  '13900000001',
  'admin',
  '11111111-1111-1111-1111-111111111111',
  'active',
  '123456'
);
```

#### 为顺达汽车创建管理员

重复上述步骤：
- Email: `lisi@shunda.com`
- Password: `123456`
- 用户名：李经理
- 车行ID：`22222222-2222-2222-2222-222222222222`

#### 为盛世车行创建管理员

重复上述步骤：
- Email: `wangwu@shengshi.com`
- Password: `123456`
- 用户名：王经理
- 车行ID：`33333333-3333-3333-3333-333333333333`

### 步骤4：使用新账号登录

创建成功后，可以使用新账号登录：

**鸿运二手车管理员**
- 邮箱：`zhangsan@hongyun.com`
- 密码：`123456`

**顺达汽车管理员**
- 邮箱：`lisi@shunda.com`
- 密码：`123456`

**盛世车行管理员**
- 邮箱：`wangwu@shengshi.com`
- 密码：`123456`

---

## 方式四：使用现有车行账号测试（临时方案）

如果只是想测试车行管理员的功能，可以使用现有的易驰汽车管理员账号：

### 登录信息
- **邮箱**：`lisi@yichi.internal`
- **密码**：`123456`
- **角色**：车行管理员
- **车行**：易驰汽车

### 操作步骤
1. 使用上述账号登录
2. 进入车行管理系统
3. 查看会员中心
4. 测试在线支付功能
5. 查看车辆管理、销售管理等功能

**注意**：这个账号对应的是易驰汽车，不是测试车行。如果需要查看测试车行的数据，请使用方式一（平台管理员账号）。

---

## 📊 测试车行数据概览

### 鸿运二手车
- **车行ID**：`11111111-1111-1111-1111-111111111111`
- **车行名称**：鸿运二手车
- **所在地**：广东省 深圳市 南山区
- **车辆数量**：15台
- **会员等级**：三级会员
- **会员状态**：已续费会员（剩余300天）
- **管理员邮箱**：`zhangsan@hongyun.internal`（需创建）
- **管理员密码**：`123456`

### 顺达汽车
- **车行ID**：`22222222-2222-2222-2222-222222222222`
- **车行名称**：顺达汽车
- **所在地**：浙江省 杭州市 西湖区
- **车辆数量**：30台
- **会员等级**：二级会员
- **会员状态**：免费期会员（剩余150天）
- **管理员邮箱**：`lisi@shunda.internal`（需创建）
- **管理员密码**：`123456`

### 盛世车行
- **车行ID**：`33333333-3333-3333-3333-333333333333`
- **车行名称**：盛世车行
- **所在地**：江苏省 南京市 鼓楼区
- **车辆数量**：8台
- **会员等级**：三级会员
- **会员状态**：免费期即将到期（剩余5天）
- **管理员邮箱**：`wangwu@shengshi.internal`（需创建）
- **管理员密码**：`123456`

---

## 🧪 测试场景

### 场景1：查看已续费会员状态
1. 使用平台管理员登录
2. 进入"会员管理"
3. 查看"鸿运二手车"的会员状态
4. 验证显示：
   - ✅ 会员等级：三级会员
   - ✅ 剩余天数：300天
   - ✅ 状态：正常会员（非试用期）
   - ✅ 有支付记录

### 场景2：查看免费期会员状态
1. 使用平台管理员登录
2. 进入"会员管理"
3. 查看"顺达汽车"的会员状态
4. 验证显示：
   - ✅ 会员等级：二级会员
   - ✅ 剩余天数：150天
   - ✅ 状态：免费期
   - ✅ 无支付记录

### 场景3：查看即将到期会员状态
1. 使用平台管理员登录
2. 进入"会员管理"
3. 查看"盛世车行"的会员状态
4. 验证显示：
   - ✅ 会员等级：三级会员
   - ✅ 剩余天数：5天
   - ✅ 状态：免费期
   - ⚠️ 显示到期提醒
   - ✅ 无支付记录

### 场景4：测试续费功能
1. 使用平台管理员登录
2. 进入"会员管理"
3. 选择"盛世车行"
4. 点击"续费"按钮
5. 填写续费信息：
   - 会员等级：三级会员
   - 支付方式：线下支付
   - 交易流水号：TEST20260119001
   - 备注：测试续费
6. 确认续费
7. 验证续费成功：
   - ✅ 剩余天数更新为365天
   - ✅ 状态更新为正常会员
   - ✅ 创建支付记录

---

## ❓ 常见问题

### Q1: 为什么测试车行没有管理员账号？

**A:** 测试车行的数据是通过SQL直接创建的，没有通过正常的注册流程创建认证用户。需要通过以下方式之一创建：
1. 使用Supabase Dashboard创建Auth用户（推荐）
2. 通过车行注册流程重新注册（需要使用不同的车行名称）
3. 使用平台管理员账号查看测试车行数据（无需创建车行管理员）

### Q2: 平台管理员和车行管理员有什么区别？

**A:** 
- **平台管理员**：
  - 可以查看和管理所有车行
  - 可以审核车行注册申请
  - 可以管理平台员工
  - 可以查看平台统计数据
  - 无法以车行身份操作车辆、销售等业务

- **车行管理员**：
  - 只能管理自己车行的数据
  - 可以管理车辆、销售、员工
  - 可以查看会员中心
  - 可以进行在线续费
  - 无法查看其他车行的数据

### Q3: 如何使用平台管理员查看测试车行数据？

**A:** 
1. 使用邮箱 `wh@yichi.internal` 和密码 `123456` 登录
2. 进入"平台管理"模式
3. 在"车行管理"中查看车行列表和详情
4. 在"会员管理"中查看和管理会员状态
5. 可以为车行续费、查看支付记录等

### Q4: 如何为测试车行创建管理员账号？

**A:** 推荐使用Supabase Dashboard创建：
1. 登录Supabase Dashboard
2. 进入 Authentication → Users
3. 创建新用户（邮箱、密码）
4. 记录用户ID
5. 在SQL Editor中创建对应的profile记录
6. 使用新账号登录系统

### Q5: 创建管理员账号后无法登录？

**A:** 
1. 确认邮箱和密码输入正确
2. 检查auth.users表中是否有对应记录
3. 检查profiles表中是否有对应记录
4. 确认profile记录的dealership_id正确
5. 确认账号状态为active
6. 尝试清除浏览器缓存后重新登录

### Q6: 为什么不能通过平台员工管理创建车行管理员？

**A:** 
- 平台员工管理是用于管理平台内部员工的
- 车行管理员属于车行的员工，不是平台员工
- 两者是完全隔离的系统
- 车行管理员需要通过车行注册流程或Supabase Dashboard创建

### Q7: 测试完成后如何清理数据？

**A:** 参考 [MEMBERSHIP_TEST_DATA.md](./MEMBERSHIP_TEST_DATA.md) 文档中的"数据清理"章节，执行提供的SQL脚本。同时需要在Supabase Dashboard中删除对应的auth用户。

---

## 📚 相关文档

- [会员状态测试数据说明](./MEMBERSHIP_TEST_DATA.md)
- [会员制系统功能说明](./MEMBERSHIP_SYSTEM_GUIDE.md)
- [在线支付功能说明](./ONLINE_PAYMENT_GUIDE.md)
- [会员中心加载失败修复说明](./MEMBERSHIP_ERROR_FIX.md)

---

## 🎯 快速开始

### 方案A：使用平台管理员查看测试数据（最简单）

1. **登录平台管理员**
   ```
   邮箱：wh@yichi.internal
   密码：123456
   ```

2. **查看测试车行**
   - 点击"车行管理"
   - 找到三个测试车行

3. **查看会员状态**
   - 点击"会员管理"
   - 查看三种不同的会员状态

4. **测试续费功能**
   - 选择"盛世车行"（即将到期）
   - 点击"续费"
   - 完成续费流程

### 方案B：创建车行管理员账号（完整测试）

1. **登录Supabase Dashboard**
   - 访问Supabase项目
   - 进入Authentication → Users

2. **创建Auth用户**
   - 邮箱：zhangsan@hongyun.com
   - 密码：123456
   - 勾选"Auto Confirm User"
   - 记录用户ID

3. **创建Profile记录**
   ```sql
   INSERT INTO profiles (
     id, username, email, phone, role,
     dealership_id, status, default_password
   ) VALUES (
     '用户ID', '张经理', 'zhangsan@hongyun.com',
     '13900000001', 'admin',
     '11111111-1111-1111-1111-111111111111',
     'active', '123456'
   );
   ```

4. **使用新账号登录**
   - 邮箱：zhangsan@hongyun.com
   - 密码：123456
   - 进入车行管理系统

### 方案C：使用现有车行账号（临时测试）

1. **登录易驰汽车管理员**
   ```
   邮箱：lisi@yichi.internal
   密码：123456
   ```

2. **测试车行功能**
   - 查看会员中心
   - 测试在线支付
   - 管理车辆和销售

**注意**：此账号对应易驰汽车，不是测试车行。

---

**文档版本**：v1.0  
**最后更新**：2026-01-19  
**适用系统**：二手车销售管理系统 v2.0+
